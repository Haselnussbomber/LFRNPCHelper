local gossipOptions = {

	---------------------------
	-- Auridormi (Cataclysm) --
	---------------------------

	-- Dragon Soul (187) --

	-- Option 1 | The Siege of Wyrmrest Temple: Morchok (311), Warlord Zon'ozz (324), Yor'sahj the Unsleeping (325), Hagara the Stormbinder (317)
	[42612] = { 187, { 311, 324, 325, 317 } },

	-- Option 2 | Fall of Deathwing: Ultraxion (331), Warmaster Blackhorn (332), Spine of Deathwing (318), Madness of Deathwing (333)
	[42613] = { 187, { 331, 332, 318, 333 } },



	----------------------------------------
	-- Lorewalker Han (Mists of Pandaria) --
	----------------------------------------

	-- Mogu'shan Vaults (317) --

	-- Option 1 | Guardians of Mogu'shan: The Stone Guard (679), Feng the Accursed (689), Gara'jal the Spiritbinder (682)
	[42620] = { 317, { 679, 689, 682 } },

	-- Option 2 | The Vault of Mysteries: The Spirit Kings (687), Elegon (726), Will of the Emperor (677)
	[42621] = { 317, { 687, 726, 677 } },


	-- Heart of Fear (330) --

	-- Option 3 | The Dread Approach: Imperial Vizier Zor'lok (745), Blade Lord Ta'yak (744), Garalon (713)
	[42622] = { 330, { 745, 744, 713 } },

	-- Option 4 | Nightmare of Shek'zeer: Wind Lord Mel'jarak (741), Amber-Shaper Un'sok (737), Grand Empress Shek'zeer (743)
	[42623] = { 330, { 741, 737, 743 } },


	-- Terrace of Endless Spring (320) --

	-- Option 5 | Protectors of the Endless (683), Tsulong (742), Lei Shi (729), Sha of Fear (709)
	[42624] = { 320, { 683, 742, 729, 709 } },


	-- Throne of Thunder (362) --

	-- Option 6 | Last Stand of the Zandalari: Jin'rokh the Breaker (827), Horridon (819), Council of Elders (816)
	[42625] = { 362, { 827, 819, 816 } },

	-- Option 7 | Forgotten Depths: Tortos (825), Megaera (821), Ji-Kun (828)
	[42626] = { 362, { 825, 821, 828 } },

	-- Option 8 | Halls of Flesh-Shaping: Durumu the Forgotten (818), Primordius (820), Dark Animus (824)
	[42627] = { 362, { 818, 820, 824 } },

	-- Option 9 | Pinnacle of Storms: Iron Qon (817), Twin Consorts (829), Lei Shen (832)
	[42628] = { 362, { 817, 829, 832 } },


	-- Siege of Orgrimmar (369) --

	-- Option 10 | Vale of Eternal Sorrows: Immerseus (852), The Fallen Protectors (849), Norushen (866), Sha of Pride (867)
	[42629] = { 369, { 852, 849, 866, 867 } },

	-- Option 11 | Gates of Retribution: Galakras (868), Iron Juggernaut (864), Kor'kron Dark Shaman (856), General Nazgrim (850)
	[42630] = { 369, { 868, 864, 856, 850 } },

	-- Option 12 | The Underhold: Malkorok (846), Spoils of Pandaria (870), Thok the Bloodthirsty (851)
	[42631] = { 369, { 846, 870, 851 } },

	-- Option 13 | Downfall: Siegecrafter Blackfuse (865), Paragons of the Klaxxi (853), Garrosh Hellscream (869)
	[42632] = { 369, { 865, 853, 869 } },



	--------------------------------------
	-- Seer Kazal (Warlords of Draenor) --
	--------------------------------------

	-- Highmaul (477) --

	-- Option 1 | Walled City: Kargath Bladefist (1128), The Butcher (971), Brackenspore (1196)
	[44390] = { 477, { 1128, 971, 1196 } },

	-- Option 2 | Arcane Sanctum: Tectus (1195), Twin Ogron (1148), Ko'ragh (1153)
	[44391] = { 477, { 1195, 1148, 1153 } },

	-- Option 3 | Imperator's Rise: Imperator Mar'gok (1197)
	[44392] = { 477, { 1197 } },


	-- Blackrock Foundry (457) --

	-- Option 4 | Slagworks: Gruul (1161), Oregorger (1202), The Blast Furnace (1154)
	[44393] = { 457, { 1161, 1202, 1154 } },

	-- Option 5 | The Black Forge: Hans'gar and Franzok (1155), Flamebender Ka'graz (1123), Kromog (1162)
	[44394] = { 457, { 1155, 1123, 1162 } },

	-- Option 6 | Iron Assembly: Beastlord Darmac (1122), Operator Thogar (1147), The Iron Maidens (1203)
	[44395] = { 457, { 1122, 1147, 1203 } },

	-- Option 7 | Blackhand's Crucible: Blackhand (959)
	[44396] = { 457, { 959 } },


	-- Hellfire Citadel (669) --

	-- Option 8 | Hellbreach: Hellfire Assault (1426), Iron Reaver (1425), Kormrok (1392)
	[44397] = { 669, { 1426, 1425, 1392 } },

	-- Option 9 | Halls of Blood: Hellfire High Council (1432), Kilrogg Deadeye (1396), Gorefiend (1372)
	[44398] = { 669, { 1432, 1396, 1372 } },

	-- Option 10 | Bastion of Shadows: Shadow-Lord Iskar (1433), Socrethar the Eternal (1427), Tyrant Velhari (1394)
	[44399] = { 669, { 1433, 1427, 1394 } },

	-- Option 11 | Destructor's Rise: Fel Lord Zakuun (1391), Xhul'horac (1447), Mannoroth (1395)
	[44400] = { 669, { 1391, 1447, 1395 } },

	-- Option 12 | The Black Gate: Archimonde (1438)
	[44401] = { 669, { 1438 } },



	------------------------------
	-- Archmage Timear (Legion) --
	------------------------------

	-- The Emerald Nightmare (768) --

	-- Option 1 | Darkbough: Nythendra (1703), Elerethe Renferal (1744), Il'gynoth (1738)
	[37110] = { 768, { 1703, 1744, 1738 } },

	-- Option 2 | Tormented Guardians: Ursoc (1667), Dragons of Nightmare (1704), Cenarius (1750)
	[37111] = { 768, { 1667, 1704, 1750 } },

	-- Option 3 | Rift of Aln: Xavius (1726)
	[37112] = { 768, { 1726 } },


	-- The Nighthold (786) --

	-- Option 4 | Arcing Aqueducts: Skorpyron (1706), Chronomatic Anomaly (1725), Trilliax (1731)
	[37113] = { 786, { 1706, 1725, 1731 } },

	-- Option 5 | Royal Athenaeum: Spellblade Aluriel (1751), Star Augur Etraeus (1732), High Botanist Tal'arn (1761)
	[37114] = { 786, { 1751, 1732, 1761 } },

	-- Option 6 | Nightspire: Krosus (1713), Tichondrius (1762), Elisande (1743)
	[37115] = { 786, { 1713, 1762, 1743 } },

	-- Option 7 | Betrayer's Rise: Gul'dan (1737)
	[37116] = { 786, { 1737 } },


	-- Trial of Valor (861) --

	-- Option 8 | Odyn (1819), Guarm (1830), Helya (1829)
	[37117] = { 861, { 1819, 1830, 1829 } },


	-- Tomb of Sargeras (875) --

	-- Option 9 | The Gates of Hell: Goroth (1862), Harjatan (1856), Mistress Sassz'ine (1861)
	[37118] = { 875, { 1862, 1856, 1861 } },

	-- Option 10 | Wailing Halls: Demonic Inquisition (1867), Sisters of the Moon (1903), The Desoalte Host (1896)
	[37119] = { 875, { 1867, 1903, 1896 } },

	-- Option 11 | Chamber of the Avatar: Maiden of Vigilance (1897), Fallen Avatar (1873)
	[37120] = { 875, { 1897, 1873 } },

	-- Option 12 | Deceiver's Fall: Kil'jaeden (1898)
	[37121] = { 875, { 1898 } },


	-- Antorus, the Burning Throne (946) --

	-- Option 13 | Light's Breach: Garothi Worldbreaker (1992), Felhounds of Sargeras (1987), Antoran High Command (1997)
	[37122] = { 946, { 1992, 1987, 1997 } },

	-- Option 14 | Forbidden Descent: Portal Keeper Hasabel (1985), Eonar the Life-binder (2025), Imonar the Soulhunter (2009)
	[37123] = { 946, { 1985, 2025, 2009 } },

	-- Option 15 | Hope's End: Kin'garoth (2004), Varimathras (1983), Coven of Shivarra (1986)
	[37124] = { 946, { 2004, 1983, 1986 } },

	-- Option 16 | Seat of the Pantheon: Aggrammar (1984), Argus the Unmaker (2031)
	[37125] = { 946, { 1984, 2031 } },



	----------------------------------------------
	-- Kiku (A) / Eppu (H) (Battle for Azeroth) --
	----------------------------------------------

	-- Uldir (1031) --

	-- Option 1 | Halls of Containment: Taloc(2168), MOTHER (2167), Zek'voz, Herald of N'Zoth (2169)
	[52303] = { 1031, { 2168, 2167, 2169 } },

	-- Option 2 | Crimson Descent: Fetid Devourer (2146), Vectis (2166), Zul, Reborn (2195)
	[52304] = { 1031, { 2146, 2166, 2195 } },

	-- Option 3 | Heart of Corruption: Mythrax the Unraveler (2194), G'huun (2147)
	[52305] = { 1031, { 2194, 2147 } },


	-- Battle of Dazar'alor (1176) --

	-- Option 4 (Horde) | Defense of Dazar'alor: Champion of the Light (2333), Grong, the Jungle Lord (2325), Jadefire Masters (2341)
	[52306] = { 1176, { 2333, 2325, 2341 } },

	-- Option 5 (Horde) | Death's Bargain: Opulence (2342), Conclave of the Chosen (2330), King Rastakhan (2335)
	[52307] = { 1176, { 2342, 2330, 2335 } },

	-- Option 6 (Horde) | Victory or Death: High Tinker Mekkatorque (2334), Stormwall Blockade (2337), Lady Jaina Proudmoore (2343)
	[52308] = { 1176, { 2334, 2337, 2343 } },

	-- Option 4 (Alliance) | Siege of Dazar'alor: Champion of the Light (2333), Jadefire Masters (2341), Grong, the Jungle Lord (2325)
	[52309] = { 1176, { 2333, 2341, 2325 } },

	-- Option 5 (Alliance) | Empire's Fall: Opulence (2342), Conclave of the Chosen (2330), King Rastakhan (2335)
	[52310] = { 1176, { 2342, 2330, 2335 } },

	-- Option 6 (Alliance) | Might of the Alliance: High Tinker Mekkatorque (2334), Stormwall Blockade (2337), Lady Jaina Proudmoore (2343)
	[52311] = { 1176, { 2334, 2337, 2343 } },


	-- Crucible of Storms (1177) --

	-- Option 7 | The Restless Cabal (2328), Uu'nat, Harbinger of the Void (2332)
	[52312] = { 1177, { 2328, 2332 } },


	-- The Eternal Palace (1179) --

	-- Option 8 | The Grand Reception: Abyssal Commander Sivara (2352), Blackwater Behemoth (2347), Radiance of Azshara (2353)
	[52313] = { 1179, { 2352, 2347, 2353 } },

	-- Option 9 | Depths of the Devoted: Lady Ashvane (2354), Orgozoa (2351), The Queen's Court (2359)
	[52314] = { 1179, { 2354, 2351, 2359 } },

	-- Option 10 | The Circle of Stars: Za'qul, Harbinger of Ny'alotha (2349), Queen Azshara (2361)
	[52315] = { 1179, { 2349, 2361 } },


	-- The Eternal Palace (1180) --

	-- Option 11 | Vision of Destiny: Wrathion, the Black Emperor (2368), Maut (2365), The Prophet Skitra (2369)
	[52316] = { 1180, { 2368, 2365, 2369 } },

	-- Option 12 | Halls of Devotion: Dark Inquisitor Xanesh (2377), Vexiona (2370), The Hivemind (2372), Ra-den the Despoiled (2364)
	[52317] = { 1180, { 2377, 2370, 2372, 2364 } },

	-- Option 13 | Gift of Flesh: Shad'har the Insatiable (2367), Drest'agath (2373), Il'gynoth, Corruption Reborn (2374)
	[52318] = { 1180, { 2367, 2373, 2374 } },

	-- Option 14 | The Waking Dream: Carapace of N'Zoth (2366), N'Zoth the Corruptor (2375)
	[52319] = { 1180, { 2366, 2375 } },


--[[
	---------------------
	-- ? (Shadowlands) --
	---------------------

	-- Castle Nathria (1190) --

	-- Option 1 | The Leeching Vaults: Huntsman Altimor (2429), Hungering Destroyer (2428), Lady Inerva Darkvein (2420)
	[?] = { 1190, { 2429, 2428, 2420 } },

	-- Option 2 | Reliquary of Opulence: Sun King's Salvation (2422), Artificer Xy'mox (2418), The Council of Blood (2426)
	[?] = { 1190, { 2422, 2418, 2426 } },

	-- Option 3 | Blood from Stone: Shriekwing (2394), Sludgefist (2394), Stone Legion Generals (2425)
	[?] = { 1190, { 2394, 2394, 2425 } },

	-- Option 3 | An Audience with Arrogance: Sire Denathrius (2424)
	[?] = { 1190, { 2424 } },


	-- Sanctum of Domination (1193) --

	-- Option 4 | The Jailer's Vanguard: Tarragrue (2435), Eye of the Jailer (2442), The Nine (2439)
	[?] = { 1193, { 2435, 2442, 2439 } },

	-- Option 5 | The Dark Bastille: Soulrender Dormazain (2445), Remnant of Ner'zhul (2444), Painsmith Raznal (2443)
	[?] = { 1193, { 2445, 2444, 2443 } },

	-- Option 6 | Shackles of Fate: Guardian of the First Ones (2446), Fatescribe Roh-Kalo (2447), Kel'Thuzad (2440)
	[?] = { 1193, { 2446, 2447, 2440 } },

	-- Option 7 | The Reckoning: Sylvanas Windrunner (2441)
	[?] = { 1193, { 2441 } },


	-- Sepulcher of the First Ones (1195) --

	-- Option 8 | Ephemeral Plains: Vigilant Guardian (2458), Skolex, the Insatiable Ravener (2465), Artificer Xy'mox (2470), Halondrus the Reclaimer (2463)
	[?] = { 1195, { 2458, 2465, 2470, 2463 } },

	-- Option 9 | Cornerstone of Creation: Dausegne, the Fallen Oracle (2459), Prototype Pantheon (2460), Lihuvim, Principal Architect (2461)
	[?] = { 1195, { 2459, 2460, 2461 } },

	-- Option 10 | Domination's Grasp: Anduin Wrynn (2469), Lords of Dread (2457), Rygelon (2467)
	[?] = { 1195, { 2469, 2457, 2467 } },

	-- Option 11 | The Grand Design: The Jailer (2464)
	[?] = { 1195, { 2464 } },
--]]

};

hooksecurefunc(GossipFrame, "Update", function(self)
	if (not UnitExists("npc")) then
		return;
	end

	local dataProvider = self.GreetingPanel.ScrollBox:GetDataProvider();
	
	for index, node in dataProvider:Enumerate() do
		if (node.buttonType == GOSSIP_BUTTON_TYPE_OPTION and node.info and gossipOptions[node.info.gossipOptionID]) then
			local override = gossipOptions[node.info.gossipOptionID];
			local instanceId = override[1];
			local encounterIds = override[2];

			local str = "";
			for j = 1, #encounterIds do
				if str ~= "" then str = str .. "\n" end

				local name, _, _, _, _, _, dungeonEncounterID, mapID = EJ_GetEncounterInfo(encounterIds[j]);
				str = str .. " - " .. name;

				if (C_RaidLocks.IsEncounterComplete(mapID, dungeonEncounterID, instanceId < 369 and 7 or 17)) then
					str = str .. " (" .. DUNGEON_ENCOUNTER_DEFEATED .. ")";
				end
			end

			local instanceName = EJ_GetInstanceInfo(instanceId);
			node.info.name = "[" .. instanceName .. "]\n" .. str;
		end
	end

	self.GreetingPanel.ScrollBox:SetDataProvider(dataProvider, ScrollBoxConstants.RetainScrollPosition);
end)
